// ==UserScript==
// @name        simple-fmc-gefs-plugin
// @namespace   andermatt64-gefs-plugins
// @version     0.0.1
// @description Simple FMC GEFS Plugin
// @author      andermatt64
// @match       http://*.gefs-online.com/gefs.php
// @grant       none
// ==/UserScript==

var APS={mode:"hold",init:function(){}},SimpleFMC={timerID:null,init:function(){this.timerID=setInterval(SimpleFMC.backgroundUpdate,1e3)},backgroundUpdate:function(){},fini:function(){null!==this.timerID&&clearInterval(this.timerID)}};!function(){"use strict";var a=function(){SimpleFMC.init(),UI.init()},b=setInterval(function(){if(window.gefs&&gefs.init)if(clearInterval(b),gefs.canvas)a();else{var c=gefs.init;gefs.init=function(){c(),a()}}},16)}();var Status={},UI={FmcHeight:"300px",infoContainer:null,statusContainer:null,apsContainer:null,routeContainer:null,logContainer:null,init:function(){$(".gefs-map-list").css("border-bottom",this.FmcHeight+" solid transparent");var a=$(".gefs-autopilot");a.empty().css("height",this.FmcHeight).css("font-family","Lucida Console, Monaco, monospace").css("font-size","9pt").css("padding","0 0 0 0");var b=function(a,b){var c=$("<button></button>");return c.text(a).css("width","100%").css("font-family","Lucida Console, Monaco, monospace").css("font-weight","bold").css("font-size","8pt").css("text-align","left").css("transition-duration","0.4s").css("border-top","1px solid #000").css("border-left","1px solid #000"),void 0!==b&&b&&c.css("border-bottom","1px solid #000"),c},c=$("<div></div>");c.css("float","left").css("width","10%").css("margin-right","0px").css("padding-right","0px");var d=$("<div></div>");d.css("float","left").css("background","#000").css("color","#0f0").css("width","90%").css("height","300px").css("margin-right","0px").css("padding-right","0px"),this.infoContainer=$("<div></div>"),this.infoContainer.css("padding","5px"),this.statusContainer=$("<div></div>"),this.statusContainer.css("padding","5px"),this.apsContainer=$("<div></div>"),this.apsContainer.css("padding","5px"),this.routeContainer=$("<div></div>"),this.routeContainer.css("padding","5px"),this.logContainer=$("<div></div>"),this.logContainer.css("padding","5px");var e=b("INFO");e.click(function(){d.empty(),d.append(UI.infoContainer)});var f=b("STAT");f.click(function(){d.empty(),d.append(UI.statusContainer)});var g=b("APS");g.click(function(){d.empty(),d.append(UI.apsContainer)});var h=b("RTE");h.click(function(){d.empty(),d.append(UI.routeContainer)});var i=b("LOG",!0);i.click(function(){d.empty(),d.append(UI.logContainer)}),d.append(this.infoContainer),c.append(e).append(f).append(g).append(h).append(i),a.append(c).append(d)}},Utils={toRadians:function(a){return a*(Math.PI/180)},toDegrees:function(a){return(a*(180/Math.PI)+360)%360},getGreatCircleBearing:function(a,b){var c=Utils.toRadians(a.lat),d=Utils.toRadians(a.lon),e=Utils.toRadians(b.lat),f=Utils.toRadians(b.lon),g=Math.sin(f-d)*Math.cos(e),h=Math.cos(c)*Math.sin(e)-Math.sin(c)*Math.cos(e)*Math.cos(f-d),i=Math.atan2(g,h);return Utils.toDegrees(i)},getGreatCircleDistance:function(a,b){var c=6371e3,d=Utils.toRadians(a.lat),e=Utils.toRadians(b.lat),f=Utils.toRadians(b.lat-a.lat),g=Utils.toRadians(b.lon-a.lon),h=Math.sin(f/2)*Math.sin(f/2)+Math.cos(d)*Math.cos(e)*Math.sin(g/2)*Math.sin(g/2),i=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),j=c*i;return j/1e3}};